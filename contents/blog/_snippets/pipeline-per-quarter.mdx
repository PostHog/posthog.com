```sql
SELECT 
    SUM(opp.amount_discounted_c)
FROM 
    salesforce_opportunity opp
JOIN 
    salesforce_user u ON opp.owner_id = u.id
WHERE 
    toDateTime(opp.close_date) >= &lbrace;variables.start_of_quarter&rbrace;
    AND toDateTime(opp.close_date) &lt; &lbrace;variables.start_of_quarter&rbrace; + INTERVAL 3 MONTH
    AND opp.forecast_category_name IN ('Commit', 'Best Case', 'Pipeline')
    AND opp.self_serve_no_interaction_c = FALSE
    AND opp.self_serve_post_engagement_c = FALSE
    AND opp.type = 'Annual Contract'
    AND u.email LIKE CONCAT('%', &lbrace;variables.account_owner&rbrace;);
```