---
title: Model Context Protocol (MCP)
---
import CalloutBox from '../../../src/components/Docs/CalloutBox'
import { CursorMCPInstallDeeplink } from '../../../src/components/Product/MCP/CursorMCPInstallDeeplink'
import MCPConfig from './snippets/mcp-config.mdx'

The PostHog [Model Context Protocol (MCP)](https://modelcontextprotocol.io/introduction) server enables your AI agents and tools to directly interact with the PostHog platform.
This guide covers how to use the MCP server and best practices for using it.

The PostHog MCP is great for having your AI agents query your data and insights without having to manually input all this data into the agent's context.
We also wrote a [great article](https://posthog.com/blog/machine-copy-paste-mcp-intro) that dives into the workings of the MCP.


## Quick install using the PostHog wizard

Besides being able to [quickly set up your project using AI](/docs/getting-started/install?tab=wizard), the [PostHog Wizard](https://github.com/PostHog/wizard) can also install the MCP server directly into **Cursor** and **Claude Desktop**. More supported tools are on the way!

```bash
# Install PostHog MCP server to supported clients
npx @posthog/wizard mcp add
```

## Manual install

<CalloutBox icon="IconInfo" title="Using Cursor or Claude Desktop?" type="fyi">
  If you're using Cursor or Claude Desktop, you can save time by using the PostHog Wizard to set up the MCP server instead!
</CalloutBox>


Start by getting a personal API key using the MCP Server preset [here](https://app.posthog.com/settings/user-api-keys?preset=mcp_server).

With it, you can add the MCP configuration to your desktop client (e.g. Cursor, Windsurf, Claude Desktop) of your choice.

<CalloutBox icon="IconInfo" title="Don't forget to use your personal API Key!" type="action">
In all examples, make sure to replace the highlighted <code>POSTHOG_AUTH_HEADER</code> environment variable placeholder with the personal API key you obtained in the first step.
</CalloutBox>

### Cursor

Skip the rest of the manual installation by installing the MCP by clicking *Add to Cursor*.

<CursorMCPInstallDeeplink/>

Alternatively, manually update the MCP configuration file:

1. Open [Cursor](https://cursor.com) and navigate to **Cursor Settings > Tools & Integrations**

2. Click **New MCP Server**

3. Update `mcp.json` with the following configuration:

<MCPConfig/>

4. **Save** the configuration file

5. You should see **posthog** under **MCP Tools** with a green status


### Claude Code

All you need to do is run the following command in your shell. Afterwards, the next time you run [Claude Code](https://www.anthropic.com/claude-code), it'll have access to the PostHog MCP.

```bash
claude mcp add-json posthog -s user '{
  "command": "npx",
  "args": [
    "-y",
    "mcp-remote@latest",
    "https://mcp.posthog.com/sse",
    "--header",
    "Authorization:${POSTHOG_AUTH_HEADER}"
  ],
  "env": {
    "POSTHOG_AUTH_HEADER": "Bearer {INSERT_YOUR_PERSONAL_API_KEY_HERE}" // HIGHLIGHT
  }
}'
```


### Claude Desktop

1. Open [Claude Desktop](http://claude.ai/download) and navigate to **Settings > Developer**

2. Click **Edit Config** to open the configuration file

3. Update `claude_desktop_config.json` with the following configuration:

<MCPConfig/>

4. **Save** the configuration file and **restart Claude Desktop**

5. The MCP server should show as **PostHog** in your list of Connectors found in **Settings > Connectors**

### Visual Studio Code (Copilot)

1. Open [Visual Studio Code](https://code.visualstudio.com/). In the command palette, run: `MCP: Open User Configuration` to open the configuration file

2. Update `mcp.json` with the following configuration:

```json
{
  "servers": {
    "posthog": {
      "command": "npx",
      "args": [
        "-y",
        "mcp-remote@latest",
        "https://mcp.posthog.com/sse",
        "--header",
        "Authorization:${POSTHOG_AUTH_HEADER}"
      ],
      "env": {
        "POSTHOG_AUTH_HEADER": "Bearer {INSERT_YOUR_PERSONAL_API_KEY_HERE}" // HIGHLIGHT
      }
    }
  }
}
```

3. **Save** the configuration file

### Windsurf

1. Open Windsurf and navigate to **Windsurf Settings > Cascade > MCP Servers**

2. Click **Manage MCP Servers**

3. Click **View raw config**

4. Update `mcp_config.json` with the following configuration:

<MCPConfig />

## Security Considerations

We recommend the following best practices to mitigate security risks when using the PostHog MCP server:

- **Use the right API key permissions:** Use the provided **MCP Server** preset in the personal API key creator. If you use the MCP in an agentic workflow on production data, scope down the API key's permissions to only the permissions you want it to use. This prevents the AI from making unintended changes to your PostHog configuration or data.

- **Project scoping:** Scope your MCP server to a specific PostHog project, limiting access to only that project's resources. This prevents AI agents from accessing data from other projects in your PostHog account and helps maintain data isolation.

- **Be mindful of prompt injection:** Keep in mind that LLMs can be tricked into following untrusted commands within user content. Always review and sanitize tool calls before executing them.

## Available Tools

Tools trigger actions on behalf of the user, based on the goals and information already in the context of the LLM. Here's a list of tools we provide:

### Organization & Project Management

Tool | Purpose | Parameters
-- | -- | -- | --
`organizations-get` | List all organizations the user has access to. | None
`set-active-organization` | Set the active organization for subsequent API calls. | `orgId` *(string, required)* – UUID of the organization to activate
`get-organization-details` | Get detailed information about the current active organization. | None
`get-projects` | List all projects within the current organization. | None
`set-active-project` | Set the active project for subsequent API calls. | `projectId` *(number, required)* – ID of the project to activate
`get-property-definitions` | Get property definitions for the current project. | None


### Feature Flags

| Tool | Purpose | Parameters |
| -- | -- | -- |
`get-all-feature-flags` | List all feature flags in the current project. | None
`get-feature-flag-definition` | Get detailed information about a specific feature flag. | `flagId` *(number, optional)* – ID of the feature flag<br/>`flagKey` *(string, optional)* – Key of the feature flag
`create-feature-flag` | Creates a new feature flag in the project. | `name` *(string, required)* – Display name for the feature flag<br/>`key` *(string, required)* – Unique key identifier for the flag<br/>`description` *(string, required)* – Description of what the flag does<br/>`filters` *(object, required)* – Targeting and rollout conditions<br/>`active` *(boolean, required)* – Whether the flag is active<br/>`tags` *(array of strings, optional)* – Tags for organization
`update-feature-flag` | Update an existing feature flag. | `flagKey` *(string, required)* – Key of the feature flag to update<br/>`data` *(object, required)* – Updated feature flag configuration
`delete-feature-flag` | Delete a feature flag from the project. | `flagKey` *(string, required)* – Key of the feature flag to delete

### Insights & Analytics

| Tool | Purpose | Parameters |
| -- | -- | -- |
| `get-all-insights` | List all insights in the current project. | `data` *(object, optional)* – Optional filtering and pagination parameters |
| `get-insight` | Get detailed information about a specific insight. | `insightId` *(number, required)* – ID of the insight to retrieve |
| `create-insight` | Create a new insight in the project. | `data` *(object, required)* – Insight configuration including query, filters, and visualization settings |
| `update-insight` | Update an existing insight. | `insightId` *(number, required)* – ID of the insight to update<br/>`data` *(object, required)* – Updated insight configuration |
| `delete-insight` | Delete an insight from the project. | `insightId` *(number, required)* – ID of the insight to delete |
| `get-sql-insight` | Query the project's PostHog data warehouse using natural language. | `query` *(string, required)* – Natural language question about the data (max 1000 characters) |

### Dashboards

| Tool | Purpose | Parameters |
| -- | -- | -- |
| `get-all-dashboards` | List all dashboards in the current project. | `data` *(object, optional)* – Optional filtering and pagination parameters |
| `get-dashboard` | Get detailed information about a specific dashboard. | `dashboardId` *(number, required)* – ID of the dashboard to retrieve |
| `create-dashboard` | Create a new dashboard in the project. | `data` *(object, required)* – Dashboard configuration including name, description, and layout |
| `update-dashboard` | Update an existing dashboard. | `dashboardId` *(number, required)* – ID of the dashboard to update<br/>`data` *(object, required)* – Updated dashboard configuration |
| `delete-dashboard` | Delete a dashboard from the project. | `dashboardId` *(number, required)* – ID of the dashboard to delete |
| `add-insight-to-dashboard` | Add an existing insight to a dashboard. | `data` *(object, required)* – Configuration for adding the insight including dashboard ID, insight ID, and layout position |

### Error Tracking

| Tool | Purpose | Parameters |
| -- | -- | -- |
| `list-errors` | List errors in the current project with filtering options. | Various filtering parameters for error querying (see schema for details) |
| `get-error-details` | Get detailed information about a specific error. | Error identification parameters (see schema for details) |

### Documentation

| Tool | Purpose | Parameters |
| -- | -- | -- |
| `docs-search` | Search the PostHog documentation for information. | `query` *(string, required)* – Search query for PostHog documentation |

### LLM Observability

| Tool | Purpose | Parameters |
| -- | -- | -- |
| `get-llm-costs` | Get LLM usage costs for the project. | `projectId` *(number, required)* – ID of the project<br/>`days` *(number, optional)* – Number of days to look back for cost data |


## Next Steps

- [PostHog MCP server](https://github.com/posthog/mcp): Check out GitHub repository for the MCP server
- [Model Context Protocol](https://modelcontextprotocol.io/introduction): Learn more about the Model Context Protocol specification
- [MCP: machine/copy paste](/blog/machine-copy-paste-mcp-intro): What exactly is MCP again?