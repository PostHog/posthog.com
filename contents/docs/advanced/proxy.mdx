---
title: Deploying a reverse proxy
sidebar: Docs
showTitle: true
---

import ProxyCallout from './_snippets/proxy-callout.mdx'
import ProxyPlatforms from './proxy/_snippets/proxy-platforms'
import ProxyDecisionTree from './proxy/_snippets/proxy-decision-tree'

<ProxyCallout />

After installing PostHog, we recommend setting up a reverse proxy to capture more events.

A reverse proxy routes events from your domain to PostHog. Instead of sending events directly to PostHog's domain, you'll send them through your own subdomain like `e.yourdomain.com`.

## Why use a reverse proxy?

Ad blockers target well-known analytics domains. They miss events sent through your own domain.

A reverse proxy helps you capture more complete data about how people use your product.

## Choose your proxy option

### Managed reverse proxy (recommended)

Let us handle everything. Point a subdomain to PostHog and we'll provision SSL certificates and routing automatically.

This is the fastest option with minimal maintenance. Requires our [platforms add-ons](/platform-packages).

<div>
<CallToAction to="/docs/advanced/proxy/managed-reverse-proxy">Set up managed reverse proxy</CallToAction>
</div>

### Deploy your own proxy

If you need full control or have infrastructure in place already, you can also deploy your own reverse proxy:

<ProxyPlatforms />

### Need help choosing?

<ProxyDecisionTree />

## After you deploy

1. Choose a subtle subdomain. Avoid words like `posthog`, `analytics`, or `tracking`. Try `e.yourdomain.com` or `ph.yourdomain.com`.

2. Set the `Host` header to match the PostHog domain your proxy is calling. Check your specific guide for instructions.

3. Update your PostHog SDK to point to your proxy domain:

```js
posthog.init('<ph_project_api_key>', {
  api_host: 'https://e.yourdomain.com',
  ui_host: 'https://us.posthog.com' // Use https://eu.posthog.com for EU region
})
```

4. Check your proxy's size limits. PostHog events can be up to 1MB and session recordings up to 64MB per message.

## Technical requirements

If you're using a tool we haven't documented, your reverse proxy needs to route requests like this:

```yaml
- route: e.yourdomain.com/static/*
  reverse_proxy: https://us-assets.i.posthog.com/static/*
  host_header: us-assets.i.posthog.com

- route: e.yourdomain.com/*
  reverse_proxy: https://us.i.posthog.com/*
  host_header: us.i.posthog.com
```

Replace `us` with `eu` for EU region.

## Best practices and common issues

### Always set `ui_host`

When using a reverse proxy, set `ui_host` to your PostHog region so features like the toolbar link correctly:

```js
posthog.init('<ph_project_api_key>', {
  api_host: 'https://e.yourdomain.com',
  ui_host: 'https://us.posthog.com' // Use https://eu.posthog.com for EU region
})
```

Without this, links from the toolbar and other features will incorrectly point to your proxy domain.

### Use the correct region

A common cause of `401` or `no_api_key` errors is mismatched regions. Make sure your proxy points to the same region as your PostHog project:

- **US region:** `us.i.posthog.com` and `us-assets.i.posthog.com`
- **EU region:** `eu.i.posthog.com` and `eu-assets.i.posthog.com`

### Avoid obvious tracking terms in your proxy path

Ad blockers may still block requests if your proxy path contains obvious tracking-related terms. Avoid paths like:

- `/analytics`
- `/tracking`
- `/telemetry`
- `/posthog`

Use neutral paths like `/ingest`, `/e`, or `/ph` instead.

### 405 Method Not Allowed errors in console

You may see 405 errors in your browser console originating from PostHog's session replay network plugin. These are typically benign and don't affect data capture.

If your events and session replays appear correctly in PostHog, you can safely ignore these console errors.

### Verify events are reaching PostHog

After setting up your proxy:

1. Open your browser's network tab
2. Trigger an event (like a page view)
3. Look for requests to your proxy domain
4. Check that responses return `200 OK`, not redirects or errors
5. Verify events appear in your PostHog dashboard

## FAQ

### Why doesn't PostHog use its own proxy?

We do. But ad blockers specifically target well-known analytics domains. When they visit `posthog.com`, they catalog our tracking scripts and add them to block lists.

Your proxy works because ad blockers haven't visited your domain to catalog your setup.

### Does PostHog provide static IP addresses?

No. Our domains use AWS infrastructure with load balancing, which rotates IPs for better performance.

If your firewall requires IP allowlisting, you have two options:

**Option 1: Use domain-based filtering instead**

Allow outbound HTTPS traffic on port 443 to `*.posthog.com`, or allow specific domains: `us.i.posthog.com` and `us-assets.i.posthog.com`. Replace `us` with `eu` for EU region.

**Option 2: Set up a reverse proxy with a static IP**

This is the recommended approach for enterprise firewalls.

1. Deploy a [reverse proxy](#choose-your-proxy-option) in your infrastructure.
2. Assign your proxy a static IP.
3. Allowlist only your proxy's IP in your firewall.

This gives you full control over network routing and avoids dependence on PostHog's rotating IPs.
