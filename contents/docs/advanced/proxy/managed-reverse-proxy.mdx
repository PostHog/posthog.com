---
title: Managed reverse proxy
sidebar: Docs
showTitle: true
iconName: IconCode
---

import { Steps, Step } from 'components/Docs/Steps'

PostHog's managed reverse proxy routes traffic through PostHog's infrastructure. We handle provisioning, SSL certificates, and routing automatically.

This option requires our [platforms add-ons](https://posthog.com/platform-packages) and access to your domain's DNS settings.

## Set up your managed proxy

<Steps>

<Step title="Create your proxy">

1. Go to [organization proxy settings](https://app.posthog.com/settings/organization-proxy)
2. Click **New Managed Proxy**
3. Enter a subdomain you control. For example, if your app runs on `myapp.com`, use `ph.myapp.com`

Choose a neutral subdomain that doesn't include words like `analytics`, `tracking`, or `posthog`. Ad blockers target obvious terms. See [configuration overview](/docs/advanced/proxy#configuration-overview) for guidance.

</Step>

<Step title="Create a DNS record">

Go to your DNS provider and create a new **CNAME record**:

1. Set the **Name** to your chosen subdomain (just the subdomain part, like `ph`)
2. Set the **Target** to the proxy domain PostHog generated in the previous step. You'll see it in your proxy settings, it looks like `4854cf84789d8596ad01.proxy-us.posthog.com`
3. Save the record

> **Note:** If you're using Cloudflare, disable proxying on this CNAME record by clicking the cloud icon and set it to **DNS only**. Cloudflare's proxy interferes with PostHog's SSL certificate provisioning.

</Step>

<Step title="Wait for provisioning">

Your proxy status will change from **waiting** → **issuing** → **live**. This typically takes 2-5 minutes but can take up to 30 minutes if DNS propagation is slow.

PostHog will automatically detect your DNS record and provision an SSL certificate. No further action needed.

> **Note:** If your proxy stays in **issuing** for more than 30 minutes, see [troubleshooting](#troubleshooting) below.

</Step>

<Step title="Update your PostHog SDK">

Update your PostHog initialization to use your new subdomain:
```js
posthog.init('<ph_project_api_key>', {
  api_host: 'https://ph.myapp.com',
  ui_host: 'https://us.posthog.com' // or https://eu.posthog.com
})
```

Replace `ph.myapp.com` with your actual subdomain, and provide your **project API key**. 

</Step>

<Step checkpoint title="Verify your setup">

Confirm events are flowing through your proxy:

1. Open your browser's developer tools and go to the **Network** tab
2. Trigger an event in your app, like a page view
3. Look for a request to your proxy subdomain (e.g., `ph.myapp.com`)
4. Verify the response is `200 OK`
5. Check the [PostHog app](https://app.posthog.com) to confirm events appear

If you see errors or events aren't appearing, see [troubleshooting](#troubleshooting) below.

</Step>

</Steps>

## Troubleshooting

For common issues like region mismatches, `ui_host` configuration, and 405 errors, see [best practices and common issues](/docs/advanced/proxy#best-practices).

### Proxy stuck in issuing state

If your proxy stays in the **issuing** state for more than 30 minutes, you may have a CAA DNS record blocking certificate issuance.

CAA (Certificate Authority Authorization) records specify which certificate authorities can issue SSL certificates for your domain. PostHog uses [Let's Encrypt](https://letsencrypt.org/) for managed proxy certificates.

To fix this, add a CAA record authorizing Let's Encrypt:

```
0 issue "letsencrypt.org"
```

You can add this to either your root domain or the specific subdomain. After adding it, DNS propagation takes a few minutes. Your proxy should move to **live** within 10 minutes.

To check if you have CAA records, use a DNS lookup tool or run:

```bash
dig CAA yourdomain.com
```

### Cloudflare shows "DNS only" but proxy still fails

If you've disabled Cloudflare's proxy but provisioning still fails:

1. Verify the cloud icon next to your CNAME record is **gray** (DNS only), not orange
2. Wait 5 minutes for Cloudflare's changes to propagate
3. Check your proxy status in PostHog

If it's still failing, temporarily pause Cloudflare on the subdomain, let PostHog provision the certificate, then re-enable Cloudflare.

### Proxy shows "Error" status

If your proxy enters an error state:

1. Verify your DNS record points to the correct target shown in PostHog
2. Check if you have CAA records blocking Let's Encrypt
3. Wait a few minutes and refresh the page. Temporary DNS issues can cause this

If the error persists, [contact support](https://app.posthog.com/home#supportModal) with your proxy subdomain and organization details.
