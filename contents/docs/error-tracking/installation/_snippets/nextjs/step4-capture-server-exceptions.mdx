import InstallNodePackageManagers from "../../../../integrate/_snippets/install-node-package-managers.mdx"

Next.js enables you to both server-side render pages and add server-side functionality. To integrate PostHog into your Next.js app on the server-side, you can use the [Node SDK](/docs/libraries/node).

First, install the `posthog-node` library:

<InstallNodePackageManagers />

For the backend, we can create a `lib/posthog-server.js` file. In it, initialize PostHog from `posthog-node` as a singleton with your project API key and host from [your project settings](https://us.posthog.com/settings/project). 

This looks like this:

```js file=lib/posthog-server.js
import { PostHog } from 'posthog-node'

let posthogInstance = null

export function getPostHogServer() {
  if (!posthogInstance) {
    posthogInstance = new PostHog(
      process.env.NEXT_PUBLIC_POSTHOG_KEY,
      {
        host: process.env.NEXT_PUBLIC_POSTHOG_HOST,
        flushAt: 1,
        flushInterval: 0,
      }
    )
  }

  return posthogInstance
}
```

You can now use the `getPostHogServer` function to capture exceptions in server-side code.

```js
const posthog = getPostHogServer()

posthog.capture("button-clicked")
```

--- 

**✅ Checkpoint** – Before proceeding, confirm that you can manually capture exceptions in server-side code.

<div className="mt-4 mb-2">
    <CallToAction type="primary" to="https://us.posthog.com/activity/explore">
        Check for server events in PostHog
    </CallToAction>
</div>