---
title: Upload source maps for Next.js
showStepsToc: true
---

<Steps>
<Step title="Install the PostHog Next.js config package" badge="required">

  ```shell
  npm install @posthog/nextjs-config
  ```

</Step>
<Step title="Add PostHog config to your Next.js app" badge="required">

  Add the following to your `next.config.js` file:

  ```js file=next.config.js

  import { withPostHogConfig } from "@posthog/nextjs-config";

  const nextConfig = {
    //...your nextjs config,
  };

  export default withPostHogConfig(nextConfig, {
    personalApiKey: process.env.POSTHOG_API_KEY, // Personal API Key
    envId: process.env.POSTHOG_ENV_ID, // Environment ID
    host: process.env.NEXT_PUBLIC_POSTHOG_HOST, // (optional), defaults to https://us.posthog.com
    sourcemaps: { // (optional)
        enabled: true, // (optional) Enable sourcemaps generation and upload, default to true on production builds
        project: "my-application", // (optional) Project name, defaults to repository name
        version: "1.0.0", // (optional) Release version, defaults to current git commit
        deleteAfterUpload: true, // (optional) Delete sourcemaps after upload, defaults to true
    },
  });

  ```

  Where you should set the following environment variables:

  <div className="overflow-x-hidden">

  | Environment Variable | Description |
  | --- | --- |
  | `POSTHOG_API_KEY` | [Personal API key](https://app.posthog.com/settings/user-api-keys#variables) with at least `write` access on `error tracking` |
  | `POSTHOG_ENV_ID` | Project ID you can find in your [project settings](https://app.posthog.com/settings/environment#variables) |
  | `NEXT_PUBLIC_POSTHOG_HOST` | Your PostHog instance URL. Defaults to `https://us.posthog.com` |
  
  </div>

</Step>

<Step checkpoint title="Verify source map generation">

Before proceeding, confirm that source maps are being generated by checking for `.js.map` files in your `dist` directory. These are the symbol sets that will be used to unminify stack traces in PostHog.

</Step>

<Step title="Inject and upload source maps" badge="required">
 
  The Next.js config package automatically handles source map injection and upload during the build process. No additional configuration is needed.

  Make sure you serve the injected files in production by running the same build and inject process in CI during deployment. PostHog will need access to these injected `chunkId` comments when building the stack traces.

</Step>

<Step checkpoint title="Verify source map upload and injection">

1. Confirm that source maps are successfully uploaded to PostHog. 

<div className="mt-4 mb-2">

<CallToAction className="mb-2"type="secondary" size="sm" to="https://app.posthog.com/settings/project-error-tracking#error-tracking-symbol-sets" external={true}>
    Check symbol sets in PostHog
</CallToAction>

</div>

2. Confirm that the served files are injected with the correct source map comment in production in dev tools:

```js 
//# chunkId=0197e6db-9a73-7b91-9e80-4e1b7158db5c
``` 

</Step>
</Steps>