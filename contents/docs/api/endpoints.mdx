---
title: Endpoints API
sidebarTitle: Overview
sidebar: Docs
showTitle: true
---

import { CalloutBox } from 'components/Docs/CalloutBox'

Endpoints enable you to create, run and access data from predefined PostHog Insights or SQL queries programmatically.  You could use endpoints for:

- Building embedded analytics.
- Pulling aggregated PostHog data into your own or other apps.

Endpoints offers a number of advantages over our query api, such as materialization (giving you better performance) and higher rate limits.

## Prerequisites

Using endpoints requires:

1. A PostHog project and your team ID, which you can get from [your project settings](https://us.posthog.com/settings/project#variables).
2. A personal API key for your project with appropriate permissions. You can create this in [your user settings](https://us.posthog.com/settings/user-api-keys#personal-api-keys).
3. An endpoint created from an Insight or SQL query in PostHog.

## Endpoint URL pattern

Endpoints follow this URL pattern:

```
/api/environments/[team_id]/endpoints/[endpoint_name]/run
```

Where:
- `[team_id]` is your PostHog team ID
- `[endpoint_name]` is the name you chose when creating the endpoint

### Example URLs

```
/api/environments/2/endpoints/example-sql-2/run
/api/environments/2/endpoints/account_users_activity/run
/api/environments/2/endpoints/daily_active_users/run
```

## Calling an endpoint

To call an endpoint, make a `GET` request to the endpoint URL with your personal API key in the `Authorization` header.

<MultiLanguage>

```bash
curl \
  -H "Authorization: Bearer $POSTHOG_PERSONAL_API_KEY" \
  <ph_app_host>/api/environments/[team_id]/endpoints/[endpoint_name]/run
```

```python
import requests

url = "<ph_app_host>/api/environments/{team_id}/endpoints/{endpoint_name}/run"
headers = {
    "Authorization": "Bearer {POSTHOG_PERSONAL_API_KEY}"
}

response = requests.get(url, headers=headers)
data = response.json()
print(data)
```

```node
import fetch from "node-fetch";

async function callEndpoint() {
  const url = "<ph_app_host>/api/environments/{team_id}/endpoints/{endpoint_name}/run";
  const headers = {
    "Authorization": "Bearer {POSTHOG_PERSONAL_API_KEY}"
  };

  const response = await fetch(url, { headers });
  const data = await response.json();
  console.log(data);
}

callEndpoint();
```

</MultiLanguage>

## Response structure

The response format depends on the underlying query type (Insight or SQL), but all responses include:

- `results`: The data returned by the endpoint
- `is_cached` (when applicable): Indicates if the result came from cache
- `timings` (when available): Performance metrics for the query execution

### Example response

```json
{
  "results": [
    {
      "date": "2024-01-01",
      "count": 1234
    },
    {
      "date": "2024-01-02",
      "count": 1456
    }
  ],
  "is_cached": true,
  "timings": {
    "query_time": 0.023
  }
}
```

## Rate limits

Endpoints have higher rate limits than standard API queries, making them suitable for production use cases. Current limits:

- Higher requests per hour than standard API queries
- Higher requests per minute than standard API queries
- Optimized for predefined queries

<CalloutBox icon="IconInfo" type="fyi" title="Rate limits">

Exact rate limits may vary based on your plan. Contact support if you need higher limits for your use case.

</CalloutBox>

## Caching

Endpoints return cached data when available to improve performance. You can check if a response is cached by checking the `is_cached` property in the response.

## Error handling

### 404 Not Found

The endpoint doesn't exist or you don't have access to it.

**Solutions:**
- Verify the endpoint name is correct
- Check that the endpoint exists in your team
- Ensure you're using the correct team ID

### 401 Unauthorized

Your API key is missing or invalid.

**Solutions:**
- Verify your personal API key is correct
- Check that your API key has the necessary permissions
- Ensure you're including the `Authorization` header

### 403 Forbidden

You don't have permission to access this endpoint.

**Solutions:**
- Check that your API key has the appropriate permissions
- Verify you're accessing an endpoint in your own team

## Best practices

### Use meaningful endpoint names

Choose descriptive names when creating endpoints:
- ✅ Good: `daily_active_users`, `account_users_activity`, `signup_funnel`
- ❌ Avoid: `endpoint1`, `test`, `query`

### Handle errors gracefully

Always check response status codes and handle errors appropriately in your application.

### Implement caching

While endpoints return cached data, you can also implement your own caching layer to reduce API calls.

### Monitor performance

Keep an eye on endpoint response times and optimize underlying queries if needed.

## Further reading

- [Endpoints overview](/docs/endpoints) - Learn what endpoints are and when to use them
- [Getting started with endpoints](/docs/endpoints/start-here) - Create your first endpoint
- [Endpoints resources](/docs/endpoints/resources) - Additional guides and examples
- [API queries](/docs/api/queries) - Learn about standard API queries

