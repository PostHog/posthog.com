---
title: iOS SDK usage
sidebarTitle: iOS
sidebar: Docs
showTitle: true
github: 'https://github.com/PostHog/posthog-ios'
platformLogo: ios
features:
  eventCapture: true
  userIdentification: true
  autoCapture: true
  sessionRecording: true
  featureFlags: true
  groupAnalytics: true
  surveys: true
  llmAnalytics: false
---

import IOSIdentify from './_snippets/identify.mdx'
import IOSSendEvents from '../../integrate/send-events/_snippets/send-events-ios.mdx'


## Capturing events

<IOSSendEvents />

## Preventing sensitive data capture

To exclude specific UI elements from autocapture or session replay, add `ph-no-capture` as either an `accessibilityLabel` or `accessibilityIdentifier`. When PostHog detects this label or identifier anywhere in the view hierarchy, the element will be either ignored or masked:

```swift
// This view will be excluded from autocapture
let view = UIView()
view.accessibilityLabel = "ph-no-capture"
```

> **Important:** By default, PostHog will make a best effort to automatically exclude fields detected as sensitive, even without the `ph-no-capture` tag. These include password fields, credit card fields, OTP fields, and any other fields related to Personally Identifiable Information (PII).

For more details on how to setup masking for session replay, please refer to our [privacy controls](/docs/session-replay/privacy?tab=iOS) documentation.

## Identifying users

> We highly recommend reading our section on [Identifying users](/docs/integrate/identifying-users) to better understand how to correctly use this method.

<IOSIdentify />

## Get the current user's distinct ID

You may find it helpful to get the current user's distinct ID. For example, to check whether you've already called `identify` for a user or not.

To do this, call `getDistinctId()`. This returns either the ID automatically generated by PostHog or the ID that has been passed by a call to `identify()`.

## Alias

Sometimes, you want to assign multiple distinct IDs to a single user. This is helpful when your primary distinct ID is inaccessible. For example, if a distinct ID used on the frontend is not available in your backend. 

In this case, you can use `alias` to assign another distinct ID to the same user.

```swift
PostHogSDK.shared.alias("alias_id")
```

We strongly recommend reading our docs on [alias](/docs/data/identify#alias-assigning-multiple-distinct-ids-to-the-same-user) to best understand how to correctly use this method.

## Anonymous vs identified events

import IdentifiedVsAnonymousIntro from '../../product-analytics/_snippets/identified-vs-anonymous-intro.mdx'

<IdentifiedVsAnonymousIntro />

### How to capture anonymous events

import HowToCaptureAnonymousEventsIOS from '../../product-analytics/_snippets/how-to-capture-anonymous-events-ios.mdx'

<HowToCaptureAnonymousEventsIOS />

### How to capture identified events

import HowToCaptureIdentifiedEventsIOS from '../../product-analytics/_snippets/how-to-capture-identified-events-ios.mdx'

<HowToCaptureIdentifiedEventsIOS />

## Setting person properties

To set [properties](/docs/data/user-properties) on your users via an event, you can leverage the event properties `userProperties` and `userPropertiesSetOnce`.

When capturing an event, you can pass a property called `$set` as an event property, and specify its value to be an object with properties to be set on the user that will be associated with the user who triggered the event.

```swift
PostHogSDK.shared.capture("signed_up", properties: ["plan": "Pro++"], userProperties: ["user_property_name": "your_value"])
```

`userPropertiesSetOnce` works just like `userProperties`, except that it will **only set the property if the user doesn't already have that property set**.

```swift
PostHogSDK.shared.capture("signed_up", properties: ["plan": "Pro++"], userPropertiesSetOnce: ["user_property_name": "your_value"])
```

## Super properties

Super properties are properties associated with events that are set once and then sent with every `capture` call, be it a `$screen`, or anything else.

They are set using `PostHogSDK.shared.register`, which takes a properties object as a parameter, and they persist across sessions.

For example, take a look at the following call:

```swift
PostHogSDK.shared.register(["team_id": 22])
```

The call above ensures that every event sent by the user will include `"team_id": 22`. This way, if you filtered events by property using `team_id = 22`, it would display all events captured on that user after the `PostHogSDK.shared.register` call, since they all include the specified Super Property.

However, please note that this does not store properties against the User, only against their events. To store properties against the User object, you should use `PostHogSDK.shared.identify`. More information on this can be found on the [Sending User Information section](#sending-user-information).

### Removing stored super properties

Super properties persist across sessions so you have to explicitly remove them if they are no longer relevant. To stop sending a super property with events, you can use `PostHogSDK.shared.unregister`, like so:

```swift
PostHogSDK.shared.unregister("team_id")
```

This removes the super property and subsequent events will not include it.

If you are doing this as part of a user logging out, you can instead simply use `PostHogSDK.shared.reset` which clears all super properties and more.

## Reset after logout

To reset the user's ID and anonymous ID, call `reset`. Usually you would do this right after the user logs out.

```swift
PostHogSDK.shared.reset()
```

## Group analytics

Group analytics allows you to associate the events for that person's session with a group (e.g. teams, organizations, etc.). Read the [Group Analytics](/docs/user-guides/group-analytics) guide for more information.

> **Note:** This is a paid feature and is not available on the open-source or free cloud plan. Learn more on the [pricing page](/pricing).

-   Associate the events for this session with a group

```swift
PostHogSDK.shared.group(type: "company", key: "company_id_in_your_db")
```

-   Associate the events for this session with a group AND update the properties of that group

```swift
PostHogSDK.shared.group(type: "company", key: "company_id_in_your_db", groupProperties: [
    "name": "ACME Corp"
])
```

The `name` is a special property which is used in the PostHog UI for the name of the group. If you don't specify a `name` property, the group ID will be used instead.

## Opt out of data capture

You can completely opt-out users from data capture. To do this, there are two options:

1. Opt users out by default by setting `optOut` to `true` in your PostHog config:

```swift
let config = PostHogConfig(apiKey: "<ph_project_api_key>", host: "<ph_client_api_host>")
config.optOut = true
PostHogSDK.shared.setup(config)
```

2. Opt users out on a per-person basis by calling `optOut()`:

```swift
PostHogSDK.shared.optOut()
```

Similarly, you can opt users in:

```swift
PostHogSDK.shared.optIn()
```

To check if a user is opted out:

```swift
PostHogSDK.shared.isOptOut()
```

## Feature flags

import FeatureFlagsLibsIntro from "../_snippets/feature-flags-libs-intro.mdx"

<FeatureFlagsLibsIntro />

import IOSFeatureFlagsCode from '../../integrate/feature-flags-code/_snippets/feature-flags-code-ios.mdx'

<IOSFeatureFlagsCode />

## Experiments (A/B tests)

Since [experiments](/docs/experiments/manual) use feature flags, the code for running an experiment is very similar to the feature flags code:

```swift
if (PostHogSDK.shared.getFeatureFlag("experiment-feature-flag-key") as? String == "variant-name") {
    // do something
}
```

It's also possible to [run experiments without using feature flags](/docs/experiments/running-experiments-without-feature-flags).

## A note about IDFA (identifier for advertisers) collection in iOS 14

Starting with iOS 14, Apple will further restrict apps that track users. Any references to Apple's AdSupport framework, even in strings, [will trip](https://github.com/PostHog/posthog-ios/issues/6) the App Store's static analysis.

Hence **starting with posthog-ios version 1.2.0** we have removed all references to Apple's AdSupport framework.

## Session replay

> **Note:** Session replay is currently only available on iOS. For future macOS support, please follow and upvote [this GitHub issue](https://github.com/PostHog/posthog-ios/issues/200).

To set up [session replay](/docs/session-replay/mobile) in your project, all you need to do is install the iOS SDK, enable "Record user sessions" in [your project settings](https://us.posthog.com/settings/project-replay) and enable the `sessionReplay` option.

## Surveys

[Surveys](/docs/surveys) launched with [popover presentation](/docs/surveys/creating-surveys#presentation) are automatically shown to users matching the [display conditions](/docs/surveys/creating-surveys#display-conditions) you set up.

## Debug mode 

If you're not seeing the expected events being captured, the feature flags being evaluated, or the surveys being shown, you can enable debug mode to see what's happening. 

You can enable debug mode by setting the `debug` option to `true` in the `PostHogConfig` object. A common pattern is to set this to `true` in development environments only for local development.

```swift
let config = PostHogConfig(apiKey: "<ph_project_api_key>", host: "<ph_client_api_host>")
config.debug = true
PostHogSDK.shared.setup(config)
```

This will enable verbose logs about the inner workings of the SDK.

You can also toggle debug by calling the `PostHogSDK.shared.debug()` method in your code.

```swift
// Enable debug mode
PostHogSDK.shared.debug(true)

// Disable debug mode
PostHogSDK.shared.debug(false)
```