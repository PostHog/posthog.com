---
title: Android
sidebarTitle: Android
sidebar: Docs
showTitle: true
github: https://github.com/PostHog/posthog-android
icon: ../../../images/docs/integrate/android.svg
features:
    eventCapture: true
    userIdentification: true
    autoCapture: false
    sessionRecording: true
    featureFlags: true
    groupAnalytics: true
---

It uses an internal queue to make calls fast and non-blocking. It also batches requests and flushes asynchronously, making it perfect to use in any part of your mobile app.

import AndroidInstall from '../../integrate/_snippets/install-android.mdx'
import AndroidSendEvents from '../../integrate/send-events/_snippets/send-events-android.mdx'
import AndroidIdentify from './\_snippets/identify.mdx'

## Installation

<AndroidInstall />

## Capturing events

<AndroidSendEvents />

## Identify

> We highly recommend reading our section on [Identifying users](/docs/integrate/identifying-users) to better understand how to correctly use this method.

<AndroidIdentify />

### Setting user properties via an event

To set [properties](/docs/data/user-properties) on your users via an event, you can leverage the event properties `userProperties` and `userPropertiesSetOnce`.

##### userProperties

**Example**

```kotlin
import com.posthog.PostHog

PostHog.capture(
    event = "button_b_clicked",
    properties = mapOf("color" to "blue"),
    userProperties = mapOf(
        "string" to "value1",
        "integer" to 2
    )
)
```

**Usage**

When capturing an event, you can pass a property called `userProperties` as an event property, and specify its value to be an object with properties to be set on the user that will be associated with the user who triggered the event.

##### userPropertiesSetOnce

**Example**

```kotlin
import com.posthog.PostHog

PostHog.capture(
    event = "button_b_clicked",
    properties = mapOf("color" to "blue"),
    userPropertiesSetOnce = mapOf(
        "string" to "value1",
        "integer" to 2
    )
)
```

**Usage**

`userPropertiesSetOnce` works just like `userProperties`, except that it will **only set the property if the user doesn't already have that property set**.

## Flush

You can set the number of events in the configuration that should queue before flushing.
Setting this to `1` will send events immediately and will use more battery. The default value for this is `20`.

You can also configure the flush interval. By default we flush all events after `30` seconds,
no matter how many events have been gathered.

```kotlin
import com.posthog.android.PostHogAndroidConfig

val config = PostHogAndroidConfig(apiKey = POSTHOG_API_KEY, host = POSTHOG_HOST).apply { 
    flushAt = 20
    flushIntervalSeconds = 30
}
```

You can also manually flush the queue:

```kotlin
import com.posthog.PostHog

PostHog.flush() 
```

## Reset

To reset the user's ID and anonymous ID, call `reset`. Usually you would do this right after the user logs out.

```kotlin
import com.posthog.PostHog

PostHog.reset()
```

## Feature Flags

import FeatureFlagsLibsIntro from "../_snippets/feature-flags-libs-intro.mdx"

<FeatureFlagsLibsIntro />

import AndroidFeatureFlagsCode from '../../integrate/feature-flags-code/_snippets/feature-flags-code-android.mdx'

<AndroidFeatureFlagsCode />

## Experiments (A/B tests)

Since [experiments](/docs/experiments/manual) use feature flags, the code for running an experiment is very similar to the feature flags code:

```kotlin
import com.posthog.PostHog

if (PostHog.getFeatureFlag("experiment-feature-flag-key") == "variant-name") {
    // do something
}
```

It's also possible to [run experiments without using feature flags](/docs/experiments/running-experiments-without-feature-flags).

## Groups

Group analytics allows you to associate the events for that person's session with a group (e.g. teams, organizations, etc.). Read the [Group Analytics](/docs/user-guides/group-analytics) guide for more information.

> **Note: ** This is a paid feature and is not available on the open-source or free cloud plan. Learn more [here](/pricing).

-   Associate the events for this session with a group

```kotlin
import com.posthog.PostHog

// organization is the group type, company_id_in_your_db is the group ID
PostHog.group(
    type = "company", 
    key = "company_id_in_your_db"
)
```

-   Associate the events for this session with a group AND update the properties of that group

```kotlin
import com.posthog.PostHog

PostHog.group(
    type = "company", 
    key = "company_id_in_your_db",
    groupProperties = mapOf("name" to "Awesome Inc.")
)
```

The `name` is a special property which is used in the PostHog UI for the name of the Group. If you don't specify a `name` property, the group ID will be used instead.

## All configuration options

When creating the PostHog client, there are many options you can set:

```kotlin
val config = PostHogAndroidConfig(apiKey = POSTHOG_API_KEY, host = POSTHOG_HOST).apply {
    // Capture certain application events automatically. (on/true by default)
    captureApplicationLifecycleEvents = true

    // Capture screen views automatically. (on/true by default)
    captureScreenViews = true // (on/true by default)

    // Capture deep links as part of the screen call. (on/true by default)
    captureDeepLinks = true

    // Maximum number of events to keep in queue before flushing (20 by default)
    flushAt = 20

    // Number of maximum events in memory and disk, when the maximum is exceed, the oldest event is deleted and the new one takes place. (1000 by default)
    maxQueueSize = 1000

    // Number of maximum events in a batch call. (50 by default)
    maxBatchSize = 50

    // Maximum delay before flushing the queue (30 seconds)
    flushIntervalSeconds = 30

    // Logs the SDK messages into Logcat. (off/false by default)
    debug = false

    // Prevents capturing any data if enabled. (off/false by default)
    optOut = false

    // Send a '$feature_flag_called' event when a feature flag is used automatically. (on/true by default)
    sendFeatureFlagEvent = true

    // Preload feature flags automatically. (on/true by default)
    preloadFeatureFlags = true

    // Callback that is called when feature flags are loaded (not set by default)
    onFeatureFlags = { ... }

    // Callback that allows to sanitize the event properties (not set by default)
    propertiesSanitizer = { properties -> ... }
}
```
