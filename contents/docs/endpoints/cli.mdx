---
title: Managing endpoints with the CLI
---

import { CalloutBox } from 'components/Docs/CalloutBox'



The PostHog CLI provides commands to manage your endpoints as code. You can version control your endpoint definitions, push changes from local YAML files, and pull existing endpoints for local editing.

## Installation

```bash
# Install the PostHog CLI
npm install -g @posthog/cli

# Authenticate
posthog login
```

<CalloutBox icon="IconInfo" title="API key scope required" type="fyi">
To manage endpoints with the CLI, your personal API key needs the `endpoint:write` scope. You can create or update your API key in [Personal API Keys](https://us.posthog.com/settings/user-api-keys).
</CalloutBox>

## Commands

### List endpoints

List all endpoints in your project:

```bash
posthog endpoint list
```

### Get endpoint details

View details of a specific endpoint:

```bash
posthog endpoint get <endpoint-name>
```

### Run an endpoint

Execute an endpoint and see the results:

```bash
# Run a remote endpoint
posthog endpoint run <endpoint-name>

# Run from a local YAML file (without creating the endpoint)
posthog endpoint run -f my-endpoint.yaml

# Pass variables
posthog endpoint run <endpoint-name> --var customer_id=cust_123

# Output as JSON
posthog endpoint run <endpoint-name> --json
```

### Open in browser

Open an endpoint in the PostHog UI:

```bash
posthog endpoint open <endpoint-name>
```

## Endpoints as code

### Pull endpoints

Download endpoints from PostHog to local YAML files:

```bash
# Pull a specific endpoint
posthog endpoint pull my-endpoint

# Pull all endpoints
posthog endpoint pull --all

# Pull to a specific directory
posthog endpoint pull --all -o ./endpoints/
```

### Push endpoints

Push local YAML files to PostHog:

```bash
# Push a single file
posthog endpoint push my-endpoint.yaml

# Push all YAML files in a directory
posthog endpoint push ./endpoints/

# Preview changes without applying
posthog endpoint push ./endpoints/ --dry-run
```

### Diff endpoints

Compare local files with remote endpoints:

```bash
posthog endpoint diff ./endpoints/
```

## YAML format

Endpoints are defined in YAML files:

```yaml
name: daily_active_users
description: Count of unique users per day

# Simple HogQL query
query: |
  SELECT
    toDate(timestamp) as date,
    count(DISTINCT distinct_id) as users
  FROM events
  WHERE event = '$pageview'
  GROUP BY date
  ORDER BY date DESC
```

### With variables

```yaml
name: events_by_customer
description: Events for a specific customer
query: |
  SELECT event, count() as count
  FROM events
  WHERE properties.customer_id = {variables.customer_id}
  GROUP BY event

variables:
  - name: customer_id
    type: string
    default: "default_customer"
```

### With materialization

```yaml
name: hourly_metrics
description: Pre-computed hourly metrics
query: |
  SELECT count() FROM events

materialization:
  enabled: true
  schedule: "1hour"  # Options: 5min, 15min, 30min, 1hour, 2hour, 4hour, 6hour, 12hour, 24hour, 7day, 30day
```

### Complex queries (insights)

For insight-based endpoints, use `query_definition` instead of `query`:

```yaml
name: signup_funnel
description: User signup funnel

query_definition:
  kind: FunnelsQuery
  funnelsFilter:
    funnelVizType: steps
  series:
    - kind: EventsNode
      event: "$pageview"
      name: "Page View"
    - kind: EventsNode
      event: "signed_up"
      name: "Signed Up"
```

## Workflow example

```bash
# 1. Pull existing endpoints
posthog endpoint pull --all -o ./posthog/endpoints/

# 2. Edit locally, commit to git
git add posthog/endpoints/
git commit -m "feat: add new customer metrics endpoint"

# 3. Preview changes
posthog endpoint diff ./posthog/endpoints/

# 4. Push to PostHog
posthog endpoint push ./posthog/endpoints/
```
